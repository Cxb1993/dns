TODO:

2. use a mpi communcator for the buffer->2d array copy in transpose.F90
3. post more messages at once in tranpose.F90?  
6. divergence: go to Shashkov formula?  


NOTES:

(1) poisson solve:  inner most tranform_to_z/transform_from_z pair
could be removed if we can compute the wave numbers of all
the coefficients in the z-decomposition .  

**********************************************************************************
structure function:
 <  [ u(x+l)-u(x) ]^p  >   


**********************************************************************************
FFT timings. 

*****************************************************************

64x64x64 timings (1cpu)  
./bench.sh 64  
run to .1 
CFL=1.5/.25

Linux laptop PGI F90
FFT99                      1.41  1.41
STK+gcc                    1.65  1.64
STK+PGCC                   1.58  1.58

Linux laptop Lahey
FFT99                      1.59  1.58
STK2+gcc                   1.72  1.71


Autrey Sun Ultra 60
FFT99   2.17  2.00 2.01
STK2    1.53  1.57 

                                 (Timings too unreliable - have to be
                                   done on 128cpus?)
Nirvana SGIFFT                 1.80
Nirvana SGIFFT 3d multiple     1.52  1.49
Nirvana FFT99                  1.32 1.54 1.35  1.47   
Nirvana STK                    1.37 1.37 1.37


Truchas (Compaq ES40)
FFT99   .34  .34  .34  
STK2    .39  .39  .39
CPQ     .42  .42  .42


*****************************************************************

1024x1024x1 timings (1cpu)  run size: 380M
./bench.sh 1024
CFL=1.5/.25

Linux laptop PGI F90
FFT99        
STK+gcc       
STK+PGCC     

Truchas Compaq ES40
FFT99     1.70  1.74  1.74
STK       1.60  1.59  1.60
CPQ       1.46  1.46  1.46


*****************************************************************

96x96x96 timings (1cpu)  runsize: 320Mb
./bench.sh 256
CFL=1.5/.25

Linux laptop Lahey
STK    3.08
FFT99  2.85 2.86



*****************************************************************

256x8x256 timings (1cpu)  runsize: 241M
./bench.sh 256
CFL=1.5/.25


Linux laptop Lahey
FFT99        4.48  4.41
STK+gcc      3.14  3.13


Truchas Compaq ES40
FFT99      1.68  1.70
STK        1.51  1.51
CPQ        1.52  1.52




**********************************************************************************
analytic CFL:  for RK4, norm(G)<2.4

dealiased:  k=KMAX*(2/3) = N/3 = 1/(3delx)


advection:  G = i 2pi  (u,v,w)dot(kx,ky,kz) delt  
            |G| <= 2pi/3 delt ( U/dx + V/dy + W/dz)

    (U/dx+V/dy+W/dz) delt <= 2.4 3 / 2pi = 1.15

1.30: seems stable 500 time steps


diffusion: G = mu 4 pi^2 (kx^2 +ky^2 + kz^2)  delt
             = mu (4/9) pi^2 (delx^-2 + dely^-2 + delz^-2)

      mu delt/(delx^2+dely^2+delz^2)  < 2.4 (9/4) / pi^2  = .55

.70: unstable
.60: seems stable.  lets go with .55



**********************************************************************************
