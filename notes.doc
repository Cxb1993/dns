TODO:

1. tune fftblocksize in fft99_interface.F90  (number of ffts to do at once)
1.1  FFT in blocks - faster if they are dimensioned:  x(lot,128)?  
2. use a mpi communcator for the buffer->2d array copy in transpose.F90
3. post more messages at once in tranpose.F90?  
4. loops in ns3d.F90
5. timers:  time initialization
            everything after initialization
            time spent in transpose operator
            time spent in ns3d
            time spent in output

6. divergence: go to Shashkov formula?  


**********************************************************************************
analytic CFL:  norm(G)<2.4
advection:  G = i U 2pi k delt  = i U (2pi/3) delt/delx
take k=KMAX*(2/3) = N/3 = 1/(3delx)
                            courant number < 1.245   (.76 w/o de-aliasing)

diffusion: G = mu 4*pi*pi *k*k delt
      mu delt/delx^2 < 2.4 * 9/(4*pi*pi) = .55   (.24 w/o de-aliasing)



**********************************************************************************
384x384  vis=.0001 - very much smoother then the vis=0 case.
CFL=1.25 looks bad at t=.5, but recovers
CFL=1.1  looks good at t=.4,.5,.6,1.0
CFL=1.0  looks good at t=.4,.5,.6...
CFL=.9  looks good


384x384  vis=0
CFL=1.1  looks great, t=.4 .. .9
    1.2  looks great
    1.3  looks bad at t=.5  has small patch of noise.  KE goes bad at t=.6	
     




CFL:  128x128

dealiased, vis=0
cfl_adv
1.6 t=6, energy up 50%
1.55 KE goes bad at 26.6
1.5 t=100 KE still looks good. didn't check plot
1.0 at t=36 KE still looks good,plot is ok


How much diffusion do we need so we can run at cfl=1.0?,
or since that has 2/3 of the full spectrum, cfl=.66?

aliased:  mu=.00001 
1.0  unstable
.10  unstable by t=10, probably earlier

aliased:  mu=.0001  
cfl
1.0  KE osscillationg around t=.8
.6:  unstable at t=18

aliased:  mu=.001  
cfl .6: unstable at t=10
aliased:  mu=.01  
cfl .6: STABLE - ran KE from 5000 down to 3

HEAT EQU.  fft, dealiased
mu=.01
cfl_vis
.40    unstable
.35    unstable
.30    stable - ran unil KE reduced 90%
.25    stable - ran until KE reduced 80%
 .1    stable - ran until KE reduced 50%.   








NOTES:

(1) poisson solve:  inner most tranform_to_z/transform_from_z pair
could be removed if we can compute the wave numbers of all
the coefficients in the z-decomposition .  



